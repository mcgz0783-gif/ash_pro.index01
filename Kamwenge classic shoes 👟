from flask import Flask, render_template_string, request, redirect
from urllib.parse import quote_plus

app = Flask(__name__)

# Updated WhatsApp number
WHATSAPP_NUMBER = "256783699626"  # Uganda format for WhatsApp redirect (+256)

HTML = """
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KAMWENGE CLASSIC SHOES DEALERS</title>
  <style>
    :root{
      --accent:#2b6cb0;
      --muted:#666;
      --bg:#f7fafc;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;}
    body{margin:0;background:var(--bg);color:#111}
    header{background:white;text-align:center;padding:25px;border-bottom:4px solid #eee;}
    header h1{margin:0;font-size:28px;font-weight:800;}
    header p{margin:5px 0;}
    .socials a{margin:4px;background:#e6f0ff;padding:6px 10px;border-radius:6px;text-decoration:none;color:#0b3b66;display:inline-block;}
    .container{max-width:1000px;margin:0 auto;padding:18px;}
    section{background:white;margin-top:18px;padding:16px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,0.05);}
    .types{display:flex;flex-wrap:wrap;gap:10px;list-style:none;padding:0;margin:10px 0;}
    .types li{background:#fff3cd;border:1px solid #ffeeba;padding:8px 12px;border-radius:20px;}
    .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin-top:10px;}
    .gallery img{width:100%;height:150px;object-fit:cover;border-radius:10px;}
    label{display:block;margin-top:10px;font-weight:600;}
    input,textarea{width:100%;padding:8px;margin-top:6px;border:1px solid #ddd;border-radius:6px;}
    textarea{min-height:100px;}
    button{margin-top:10px;padding:10px 14px;background:var(--accent);color:white;border:none;border-radius:8px;cursor:pointer;}
    footer{text-align:center;padding:15px;margin-top:20px;color:#666;font-size:14px;}
  </style>
</head>
<body>
<header>
  <h1>KAMWENGE CLASSIC SHOES DEALERS</h1>
  <p>Opposite Kabuga Road near Round About — Kamwenge Town Council</p>
  <p>Call / WhatsApp: <strong>0783699626</strong></p>
  <div class="socials">
    <a href="https://facebook.com/kamwengeclassicshoesdealers" target="_blank">@kamwenge classic shoes dealers</a>
    <a href="https://instagram.com/kamwengeclassicshoesdealers" target="_blank">@kamwenge classic shoes dealers</a>
    <a href="https://tiktok.com/@kamwengeclassicshoesdealers" target="_blank">@kamwenge classic shoes dealers</a>
    <a href="https://twitter.com/kamwengeclassicshoesdealers" target="_blank">@kamwenge classic shoes dealers</a>
  </div>
</header>

<div class="container">
  <section>
    <h2>We Swap & Sell All Types of Shoes</h2>
    <ul class="types">
      <li>Musonso</li>
      <li>Sneakers</li>
      <li>Jungle Boots</li>
      <li>African Crafts</li>
      <li>Italian Boots</li>
      <li>Other Local Shoes</li>
    </ul>

    <div class="gallery">
      <img src="https://images.unsplash.com/photo-1584735174914-6b5c1b03c6b6?auto=format&fit=crop&w=800&q=60" alt="Sneakers">
      <img src="https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?auto=format&fit=crop&w=800&q=60" alt="Italian Boots">
      <img src="https://images.unsplash.com/photo-1600181953015-dc9a1a6b6663?auto=format&fit=crop&w=800&q=60" alt="Jungle Boots">
      <img src="https://images.unsplash.com/photo-1616628188541-1d939d6c192f?auto=format&fit=crop&w=800&q=60" alt="African Crafts">
      <img src="https://images.unsplash.com/photo-1519744792095-2f2205e87b6f?auto=format&fit=crop&w=800&q=60" alt="Local Shoes">
    </div>
  </section>

  <section>
    <h2>Delivery Points</h2>
    <p>We deliver to Mbarara City, Fort Portal Town, Kyenjojo Town, and all corners of Kamwenge District.</p>
  </section>

  <section>
    <h2>Payment Methods</h2>
    <p>Pay via Mobile Money (MTN & Airtel): <strong>0783699626</strong></p>
    <p>Orders can also be made online or directly through WhatsApp on the same number.</p>
  </section>

  <section>
    <h2>Place Your Order Online</h2>
    <form method="POST" action="/order">
      <label>Your Name</label>
      <input name="name" required>

      <label>Phone Number</label>
      <input name="phone" placeholder="078x xxx xxx">

      <label>Items (type, size, quantity)</label>
      <textarea name="items" required></textarea>

      <label>Delivery Address</label>
      <input name="address" placeholder="Your delivery location">

      <button type="submit">Send Order via WhatsApp</button>
    </form>
  </section>

  <section>
    <h2>Contact Us</h2>
    <p>Reach us anytime on WhatsApp or call <strong>0783699626</strong></p>
    <form method="POST" action="/message">
      <label>Your Name</label>
      <input name="cname" required>
      <label>Email (optional)</label>
      <input name="cemail" type="email">
      <label>Your Message</label>
      <textarea name="cmessage" required></textarea>
      <button type="submit">Send Message</button>
    </form>
  </section>
</div>

<footer>
  &copy; {{year}} KAMWENGE CLASSIC SHOES DEALERS — Opposite Kabuga Road, Kamwenge Town Council
</footer>
</body>
</html>
"""

@app.route("/")
def home():
    from datetime import datetime
    return render_template_string(HTML, year=datetime.now().year)

@app.route("/order", methods=["POST"])
def order():
    name = request.form.get("name")
    phone = request.form.get("phone")
    items = request.form.get("items")
    address = request.form.get("address")
    message = f"New order from {name}, Phone: {phone}. Items: {items}. Address: {address}."
    wa_link = f"https://wa.me/{WHATSAPP_NUMBER}?text=" + quote_plus(message)
    return redirect(wa_link)

@app.route("/message", methods=["POST"])
def message():
    cname = request.form.get("cname")
    cemail = request.form.get("cemail")
    cmessage = request.form.get("cmessage")
    text = f"Message from {cname} ({cemail}): {cmessage}"
    wa_link = f"https://wa.me/{WHATSAPP_NUMBER}?text=" + quote_plus(text)
    return redirect(wa_link)

if __name__ == "__main__":
    app.run(debug=True, port=5000)
